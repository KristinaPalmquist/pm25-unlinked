<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0"
    />
    <title>PM 2.5 Air Quality Forecast</title>

    <link
      rel="preconnect"
      href="https://fonts.googleapis.com"
    />
    <link
      rel="preconnect"
      href="https://fonts.gstatic.com"
      crossorigin
    />
    <link
      rel="stylesheet"
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700;900&display=swap"
    />

    <link
      rel="stylesheet"
      href="https://unpkg.com/maplibre-gl@3.6.2/dist/maplibre-gl.css"
    />
    <link href="styles/output.css" rel="stylesheet" />
  </head>
  <body class="bg-gray-50 text-gray-900">
    <div class="relative h-screen w-screen overflow-hidden">
      <header
        class="w-full border-2 border-black bg-white px-6 py-2"
      >
        <div id="header-container" class="w-full">
          <h1
            id="app-header"
            class="m-0 block whitespace-nowrap font-sans font-normal uppercase"
          >
            PM 2.5 Air Quality Forecast
            <span id="region-name"></span>
          </h1>
        </div>
      </header>

      <!-- Main Map Area -->
      <div
        id="map"
        class="absolute inset-0 border-2 border-black"
      ></div>

      <!-- Bottom UI -->
      <div
        id="bottom-ui"
        class="absolute bottom-4 left-0 right-0 z-50 pointer-events-none"
      >
        <!-- Left container: days by default (small); toggles on xl+ -->
        <div
          id="bottom-left"
          class="absolute bottom-0 left-0 pointer-events-auto flex flex-col items-start gap-4"
        >
          <section
            id="day-selector"
            class="pointer-events-auto flex flex-col min-[1100px]:flex-row items-start text-gray-900"
            aria-label="Day selection"
          >
            <div
              class="flex flex-col min-[1100px]:flex-row border-2 border-black divide-y-2 divide-black min-[1100px]:divide-y-0 min-[1100px]:divide-x-2"
            >
              <button
                data-day="0"
                class="day-button bg-white text-black px-6 py-3 text-xs font-black uppercase tracking-widest hover:bg-black hover:text-white transition-colors data-[active=true]:bg-sensor-good data-[active=true]:text-black"
                data-active="true"
              >
                Today
              </button>
              <button
                data-day="1"
                class="day-button bg-white text-black px-6 py-3 text-xs font-black uppercase tracking-widest hover:bg-black hover:text-white transition-colors data-[active=true]:bg-sensor-good data-[active=true]:text-black"
              >
                Tomorrow
              </button>
              <button
                data-day="2"
                class="day-button bg-white text-black px-6 py-3 text-xs font-black uppercase tracking-widest hover:bg-black hover:text-white transition-colors data-[active=true]:bg-sensor-good data-[active=true]:text-black"
              >
                <span class="weekday-label"></span>
              </button>
              <button
                data-day="3"
                class="day-button bg-white text-black px-6 py-3 text-xs font-black uppercase tracking-widest hover:bg-black hover:text-white transition-colors data-[active=true]:bg-sensor-good data-[active=true]:text-black"
              >
                <span class="weekday-label"></span>
              </button>
              <button
                data-day="4"
                class="day-button bg-white text-black px-6 py-3 text-xs font-black uppercase tracking-widest hover:bg-black hover:text-white transition-colors data-[active=true]:bg-sensor-good data-[active=true]:text-black"
              >
                <span class="weekday-label"></span>
              </button>
              <button
                data-day="5"
                class="day-button bg-white text-black px-6 py-3 text-xs font-black uppercase tracking-widest hover:bg-black hover:text-white transition-colors data-[active=true]:bg-sensor-good data-[active=true]:text-black"
              >
                <span class="weekday-label"></span>
              </button>
              <button
                data-day="6"
                class="day-button bg-white text-black px-6 py-3 text-xs font-black uppercase tracking-widest hover:bg-black hover:text-white transition-colors data-[active=true]:bg-sensor-good data-[active=true]:text-black"
              >
                <span class="weekday-label"></span>
              </button>
            </div>
          </section>
        </div>

        <!-- Center container: receives days only on 1400px+; empty below that -->
        <div
          id="bottom-center"
          class="absolute bottom-0 left-1/2 -translate-x-1/2 pointer-events-auto flex flex-col items-center gap-4"
        ></div>

        <!-- Right container: toggles by default (small); legend always -->
        <div
          id="bottom-right"
          class="absolute bottom-0 right-0 pointer-events-auto flex flex-col items-end gap-4"
        >
          <!-- Toggle Controls: default position (small screens); JS moves them -->
          <section
            id="toggle-controls"
            class="flex flex-col text-gray-900"
            aria-label="Toggle controls"
          >
            <div
              class="flex flex-col min-[1100px]:flex-row border-2 border-black divide-y-2 divide-black min-[1100px]:divide-y-0 min-[1100px]:divide-x-2"
            >
              <button
                id="toggle-sensors"
                class="bg-white text-black px-6 py-3 text-xs font-black uppercase tracking-widest hover:bg-black hover:text-white transition-colors data-[active=true]:bg-sensor-good data-[active=true]:text-black"
                data-active="true"
              >
                Sensors
              </button>
              <button
                id="toggle-overlay"
                class="bg-white text-black px-6 py-3 text-xs font-black uppercase tracking-widest hover:bg-black hover:text-white transition-colors data-[active=true]:bg-sensor-good data-[active=true]:text-black"
                data-active="true"
              >
                Heatmap
              </button>
            </div>
          </section>

          <!-- Legend -->
          <aside
            id="legend-area"
            class="flex flex-col items-start bg-white border-2 border-black p-6 font-swiss"
            aria-label="Air quality legend"
          >
            <h3
              class="text-[10px] font-black uppercase tracking-[0.3em] mb-4"
            >
              Air Quality Index [PM 2.5]
            </h3>
            <div class="flex flex-col gap-1 w-64">
              <div
                class="flex h-8 w-full border-2 border-black"
              >
                <div
                  class="flex-1 bg-sensor-good"
                  title="Good"
                ></div>
                <div
                  class="flex-1 bg-sensor-moderate"
                  title="Moderate"
                ></div>
                <div
                  class="flex-1 bg-sensor-sensitive"
                  title="Sensitive"
                ></div>
                <div
                  class="flex-1 bg-sensor-unhealthy"
                  title="Unhealthy"
                ></div>
                <div
                  class="flex-1 bg-sensor-hazardous"
                  title="hazardous"
                ></div>
              </div>
              <div
                class="flex justify-between text-[9px] font-black uppercase mt-1 italic"
              >
                <span>0 / Good</span>
                <span>500 / Danger</span>
              </div>
            </div>
          </aside>
        </div>
      </div>
    </div>

    <div id="image-modal" class="image-modal hidden">
      <div
        id="image-modal-backdrop"
        class="image-modal-backdrop"
      ></div>
      <div class="image-modal-content">
        <button
          id="image-modal-close"
          class="image-modal-close"
          aria-label="Close image"
        >
          ×
        </button>
        <img id="image-modal-img" alt="Expanded plot" />
      </div>
    </div>

    <div id="details-modal" class="details-modal hidden">
      <div
        id="details-modal-backdrop"
        class="details-modal-backdrop"
      ></div>
      <div class="details-modal-content">
        <header
          class="flex items-center justify-between gap-4"
        >
          <div class="flex items-center gap-2">
            <!-- <h3 class="text-base font-semibold">Sensor details:</h3> -->
            <p
              id="details-modal-title"
              class="text-base font-semibold"
            ></p>
          </div>
          <button
            id="details-modal-close"
            class="details-modal-close"
            aria-label="Close details"
          >
            ×
          </button>
        </header>
        <div class="details-table-wrapper">
          <table>
            <thead id="details-table-head"></thead>
            <tbody id="details-table-body"></tbody>
          </table>
        </div>
      </div>
    </div>

    <section
      class="grid grid-cols-1 md:grid-cols-12 border-t-8 border-black font-swiss bg-white w-full"
    >
      <div
        class="md:col-span-2 p-6 border-b-4 md:border-b-0 md:border-r-4 border-black flex flex-col justify-between bg-white"
      >
        <div>
          <span
            class="text-[12vw] md:text-[8vw] font-black leading-none tracking-tighter block"
            >01</span
          >
          <h2
            class="text-3xl font-black uppercase mt-4 leading-none"
          >
            The<br />Forecast<br />Model
          </h2>
        </div>
        <p
          class="text-[10px] font-black uppercase tracking-[0.4em] mt-12 text-slate-400s"
        >
          Project / Air Quality
        </p>
      </div>

      <div
        class="md:col-span-7 p-6 border-b-4 md:border-b-0 md:border-r-4 border-black flex-flex-col justify-center"
      >
        <h3
          class="text-xs font-black uppercase mb-8 tracking-[0.2em]"
        >
          [ Abstract ]
        </h3>
        <p
          class="text-3xl md:text-4xl font-bold leading-[1.1] tracking-tighter"
        >
          We utilize historical sensor data to train a
          machine learning model that predicts
          <span class="bg-black text-white px-2"
            >PM 2.5</span
          >
          levels one week into the future. Visualizing
          invisible health risks through open data
        </p>
      </div>

      <div
        class="md:col-span-3 p-6 bg-black text-white flex flex-col justify-between"
      >
        <div>
          <h3
            class="text-[10px] font-black uppercase tracking-[0.3em] mb-10 text-slate-500"
          >
            Technical Specs
          </h3>

          <div class="space-4x">
            <div
              class="flex justify-between border-b border-zinc-800 pb-2"
            >
              <span class="text-[10px] font-bold uppercase"
                >Algorithm</span
              >
              <span
                class="text-[10px] font-bold uppercase text-slate-400"
                >XGBooster</span
              >
            </div>

            <div
              class="flex justify-between border-b border-zinc-800 pb-2"
            >
              <span class="text-[10px] font-bold uppercase"
                >Target</span
              >
              <span
                class="text-[10px] font-bold uppercase text-slate-400"
                >PM 2.5 μg/m³</span
              >
            </div>
            <div
              class="flex justify-between border-b border-zinc-800 pb-2"
            >
              <span class="text-[10px] font-bold uppercase"
                >Update rate</span
              >
              <span
                class="text-[10px] font-bold uppercase text-slate-400"
                >every 8 hours</span
              >
            </div>

            <div
              class="flex justify-between border-b border-zinc-800 pb-2"
            >
              <span
                class="block text-[10px] font-black uppercase text-slate-500 mb-1 italic"
                >Data Source / API</span
              >
              <a
                href="https://aqicn.org/"
                target="_blank"
                class="text-[10px] font-bold uppercase hover:text-sensor-good transition-colors italic"
                >Aqicn.org [World Air Quality]</a
              >
            </div>

            <div
              class="flex justify-between border-b border-zinc-800 pb-2"
            >
              <span
                class="block text-[10px] font-black uppercase text-slate-500 mb-1 italic"
                >Infrastructure / MLOps</span
              >
              <a
                href="https://hopsworks.ai/"
                target="_blank"
                class="text-[10px] font-bold uppercase hover:text-sensor-good transition-colors italic"
                >Hopsworks</a
              >
            </div>

            <div
              class="flex justify-between border-b border-zinc-800 pb-2"
            >
              <span
                class="block text-[10px] font-black uppercase text-slate-500 mb-1 italic"
                >Base Architecture / Fork</span
              >
              <a
                href="https://github.com/Tegelstenen/pm25-forecast-openmeteo-aqicn"
                target="_blank"
                class="text-[10px] font-bold uppercase hover:text-sensor-good transition-colors italic"
                >@Tegelstenen [GitHub]</a
              >
            </div>
          </div>
        </div>

        <div class="mt-8 flex items-center gap-4">
          <div class="relative flex h-3 w-3">
            <span
              class="animate-ping absolute inline-flex h-full w-full rounded-full bg-sensor-good opacity-75"
            >
            </span>
            <span
              class="relative inline-flex rounded-full h-3 w-3 bg-sensor-good"
            ></span>
          </div>
          <span
            class="text-[10px] font-black uppercase tracking-widest"
            >Stream: Active</span
          >
        </div>
      </div>
    </section>

    <script src="https://unpkg.com/maplibre-gl@3.6.2/dist/maplibre-gl.js"></script>
    <script type="module" src="./js/main.js"></script>
  </body>
</html>
